<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="xterm.css" />
    <script src="xterm.js"></script>
</head>
<body>
<div id="terminal"></div>
<!-- this has random console color output code for Node.JS, for example:
 red = "\x1b[31m"
 green = "\x1b[32m"
 cyan = "\x1b[36m"
 reset = "\x1b[0m" //-->

<!-- term.onKey() takes user input in the terminal and sends it through the WebSocket.
     Currently unable to delete or backspace input //-->
<script>
        var term = new Terminal();
        var shellPrompt = '$ ';
        term.open(document.getElementById('terminal'));

        term.writeln('Hello from\x1B[1;3;32m xterm.js\x1B[0m $ ')
        prompt();
        term.setOption('cursorBlink', true);

        var str = "";
        term.onKey(e => {
            str += e.key;
            console.log(e.key);
            term.write(e.key);
            if (e.key == '\r') {
                term.write('\n');
                ws.send(str);
                str = "";
                }
        });

        function prompt() {
        term.write('\r' + shellPrompt);
        };

        const ws = new WebSocket("ws://localhost:9000");
        const msg = "frontend WebSocket is now open"

        ws.addEventListener("open", () =>{
          console.log("connected to server");
          ws.send(msg);
        });

        ws.onmessage = function (event) {
            console.log(event.data);
            term.writeln(event.data);
            prompt();
        };
      </script>
</body>
</html>
